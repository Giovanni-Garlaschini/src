<!-- Singola todo item -->
<div class="todo-item" [class.completed]="todo.completed">
  <div class="todo-content">
    <!-- Checkbox per segnare come completata -->
    <input
      type="checkbox"
      [checked]="todo.completed"
      (change)="onToggleComplete()"
      class="checkbox">

    <div class="todo-details">
      <!-- Modalità visualizzazione: mostra i dati del task -->
      <div *ngIf="!isEditing">
        <span class="todo-title">{{ todo.title }}</span>
        <div class="todo-info">
          <span *ngIf="todo.assignedTo" class="assigned-to">
            Assigned to: {{ todo.assignedTo }}
          </span>
          <span class="due-date">
            Date: {{ formatDate(todo.dueDate) }}
          </span>
        </div>
      </div>

      <!-- Modalità modifica: mostra i campi input per modificare il task -->
      <div *ngIf="isEditing" class="edit-mode">
        <!-- Input per modificare il titolo -->
        <input
          type="text"
          [(ngModel)]="editedTitle"
          class="edit-input edit-title"
          placeholder="Task title">

        <div class="edit-info">
          <!-- Input per modificare la persona a cui assegni il task -->
          <input
            type="text"
            [(ngModel)]="editedAssignedTo"
            class="edit-input edit-assigned"
            placeholder="Assigned to">

          <!-- Input per modificare la data di scadenza -->
          <input
            type="date"
            [(ngModel)]="editedDueDate"
            class="edit-input edit-date">
        </div>

        <!-- Pulsanti per salvare o annullare le modifiche -->
        <div class="edit-actions">
          <button (click)="saveEdit()" class="save-button">Save</button>
          <button (click)="cancelEdit()" class="cancel-button">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pulsanti azione -->
  <div class="action-buttons">
    <!-- Pulsante modifica con icona penna, visibile solo se non in modalità modifica -->
    <button
      *ngIf="!isEditing"
      (click)="startEdit()"
      class="edit-button"
      title="Modifica task">
      ✏️
    </button>

    <!-- Pulsante elimina, visibile solo se la todo è completata -->
    <button
      *ngIf="todo.completed"
      (click)="onDelete()"
      class="delete-button">
      Delete
    </button>
  </div>
</div>

<!-- Pop-up di conferma cancellazione -->
<!-- L'overlay viene mostrato solo quando showDeleteConfirm è true -->
<div *ngIf="showDeleteConfirm" class="delete-confirm-overlay">
  <!-- Dialog centrale con il messaggio di conferma -->
  <div class="delete-confirm-dialog">
    <!-- Messaggio che chiede conferma all'utente -->
    <p class="delete-confirm-message">Sei sicuro di voler cancellare questo task?</p>
    <!-- Contenitore dei pulsanti di scelta -->
    <div class="delete-confirm-buttons">
      <!-- Pulsante SI: conferma ed elimina il task -->
      <button (click)="confirmDelete()" class="confirm-yes-button">SI</button>
      <!-- Pulsante NO: annulla e chiude il pop-up -->
      <button (click)="cancelDelete()" class="confirm-no-button">NO</button>
    </div>
  </div>
</div>